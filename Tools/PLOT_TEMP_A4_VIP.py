# -*- coding: cp1256 -*-
import arcpy
import datetime
import uuid
import os,math,numpy
#===========================================================================================================
arcpy.env.overwriteOutput = True
#===========================================================================================================
arcpy.AddMessage("Collecting input parameters")
#-----------------------------------------------------------------------------------------------------------
REQNUM = arcpy.GetParameterAsText(0)
TempalteName = arcpy.GetParameterAsText(1)
templaterows = arcpy.GetParameterAsText(4)
Scale = arcpy.GetParameterAsText(5)
#===========================================================================================================
arcpy.AddMessage("Loading MapDocument")
#-----------------------------------------------------------------------------------------------------------
if templaterows == "":
        DocumentPath = r"//AD007APP06/gisapplications/gisapps/sddsps/Templates/" + TempalteName +  ".mxd"
else:
        DocumentPath = r"//AD007APP06/gisapplications/gisapps/sddsps/Templates/" + TempalteName + "_" + templaterows +  ".mxd"
arcpy.AddMessage(DocumentPath)
#DocumentPath = outputMap
mxd = arcpy.mapping.MapDocument(DocumentPath)
pDataFrame = arcpy.mapping.ListDataFrames(mxd, "Layers")[0]
pSpatialReference = pDataFrame.spatialReference
#===========================================================================================================
arcpy.AddMessage("Getting Sitemap Info")
#-----------------------------------------------------------------------------------------------------------
V_SM_FULL_INFO = arcpy.mapping.ListTableViews(mxd,"V_SM_FULL_INFO")[0]
pCursor = arcpy.da.SearchCursor(V_SM_FULL_INFO, "*" ,"REQNUM = '" + REQNUM + "'")
intcount = 0
for row in pCursor:
        intcount += 1
        OwnerName = row[2]
        Tenant = row[3]
        TheDate = row[4]
        TRANSACTION_DESCRIPTION_ARA = row[5]
        REQUEST_BY = row[6]
        LETTER_NO = row[7]
        LETTER_DATE = row[8]
        OWNER_LABEL = row[9]
        TENANT_LABEL = row[10]
        BENEFICIARY_LABEL = row[11]
        REMARKS = row[12]
        DRAFTSMAN_NAME = row[15]
        MAP_ANGLE = row[22]
        MAP_XMIN = row[23]
        MAP_YMIN = row[24]
        MAP_XMAX = row[25]
        MAP_YMAX = row[26]
        TMP_RENTSTARTDATE = row[27]
        TMP_RENTENDDATE = row[28]
        TMP_RENTENDDETAILS = row[29]
        MSQ_APPROVEDBY = row[30]
        MSQ_LETTERNO = row[31]
        MSQ_LLETTERDATE = row[32]
        DONATORNAME = row[33]
        MOSQUECAPACITY = row[34]
        UPD_LETTER_NO = row[35]
        UPD_LETTER_DATE = row[36]
        SURVEY_REPORT_NO = row[37]
        SURVEY_REPORT_DATE = row[38]
        CopyTo = row[39]
        ARCHIVE_PATH = row[41]
        LayersPath = row[43]
        PLOTAREAM = row[45]
        PLOTAREAF = row[46]
        CUTAREAM = row[47]
        CUTAREAF = row[48]
        EXTAREAM =row[49]
        EXTAREAF = row[50]
        PlotUse = row[51]
        UserName = row[54]
        BENEFICIARY = row[55]
        PAYEE = row[56]
        purpose = row[57]
        Zone = row[58]
        Sector = row[59]
        Plot = row[60]
        OPERATION_TYPE = row[61]
        arcpy.AddMessage(OPERATION_TYPE)
        Period = row[62]
        SMFOREN = row[70]
        REMARKS_FONTSIZE = row[72]
        LANDTYPE_FONTSIZE = row[73]
        PLOTBNDRY_DASHED = row[74]
        ACTION_FONTSIZE = row[76]
        PLOT_LABEL = row[77]
        COOD_SIZE = row[78]
        PLOTNUMBER_SIZE = row[79]
        PLOTEXTN_FONTSIZE = row[80]
        DIMENSIONS_FONTSIZE = row[82]
        SURRONDED_PLOTS_FONTSIZE = row[83]
        ZONE_FONTSIZE = row[84]
        SECTOR_FONTSIZE = row[85]
        ALLOCATIONTYPE_DM = row[86]
        PURPOSEOFUSE = row[87]
        WTYPEID = row[88]
        DMT_PRINT_USAGE= row[89]

if intcount <> 0:        
        #===========================================================================================================
        arcpy.AddMessage("Adding Map Layers")
        #-----------------------------------------------------------------------------------------------------------
        pDataFrame.rotation = MAP_ANGLE

        #if Plot == "Bulk":
        V_BULKREQUEST_PLOTINTERNALIDS = arcpy.mapping.ListTableViews(mxd,"V_BULKREQUEST_PLOTINTERNALIDS")[0]
        nCursor = arcpy.da.SearchCursor(V_BULKREQUEST_PLOTINTERNALIDS,["PLOTINTERNALID"],"REQNUM = '" + REQNUM + "'")
        BulkPlotids = []
        for row in nCursor:
                BulkPlotids.append(row[0])
        BulkPlotids = ','.join(["'{}'".format(value) for value in BulkPlotids])
        
        V_SM_LAYERS_TOSHOW = arcpy.mapping.ListTableViews(mxd,"V_SM_LAYERS_TOSHOW")[0]
        searchcursor = arcpy.da.SearchCursor(V_SM_LAYERS_TOSHOW, "*" ,"REQNUM = '" + REQNUM + "'")
        lylist = []
        for row in searchcursor:
                lyname = row[2]
                lylist.append(lyname)

        satelliteexist = None
        lyname = "SATELLITE2018"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2017"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2019Nov"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2019Ortho"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "NP_Centroid"
        if lyname in lylist:
                NP_Centroid_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                NP_Centroid_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "'"
                arcpy.mapping.AddLayer(pDataFrame, NP_Centroid_Layer, "BOTTOM")
        lyname = "NP_Points"
        if lyname in lylist:
                NP_Points_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if NP_Points_Layer.supports("LABELCLASSES"):
                                if NP_Points_Layer.showLabels:
                                        for lblClass in NP_Points_Layer.labelClasses:
                                                if lblClass.className == "PLOT":
                                                #if lblClass.showClassLabels:
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(COOD_SIZE) +"'>\" & [POINT_NUMBER_FINAL] & \"</FNT>\""
                NP_Points_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "' AND POINT_NUMBER_VISIBLE = 1"
                arcpy.mapping.AddLayer(pDataFrame, NP_Points_Layer, "BOTTOM")
        lyname = "NP_Dimensions"
        if lyname in lylist:
                NP_Dimensions_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if NP_Dimensions_Layer.supports("LABELCLASSES"):
                                if NP_Dimensions_Layer.showLabels:
                                        for lblClass in NP_Dimensions_Layer.labelClasses:
                                                if lblClass.className == "PLOT":
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(DIMENSIONS_FONTSIZE) +"'>\" & [D_LENGTH] & \"</FNT>\""
                NP_Dimensions_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "'AND D_LENGTH_VISIBLE = 1"
                arcpy.mapping.AddLayer(pDataFrame, NP_Dimensions_Layer, "BOTTOM")
        #===========================================================================================================
        if OPERATION_TYPE == "Plot Adjustment":
                PLOT_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT_Adjustment.lyr")
                if Plot == "Bulk":
                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                if Plot <> "Bulk":
                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                arcpy.mapping.AddLayer(pDataFrame, PLOT_Adjustment, "BOTTOM")
        if OPERATION_TYPE == "Plot Shifting":
                PLOT_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT_Adjustment.lyr")
                if Plot == "Bulk":
                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                if Plot <> "Bulk":
                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                arcpy.mapping.AddLayer(pDataFrame, PLOT_Adjustment, "BOTTOM")
        if OPERATION_TYPE == "Plot Extension Adjustment":
                dCursor = arcpy.da.SearchCursor(LayersPath + "\\" + "NewPlots.lyr",["SECTORTPSSNUMBER","PLOTNUMBER"],"REQNUM = '" + REQNUM + "'")
                DesignbulkPlotids = []
                for row in dCursor:
                        DesignbulkPlotids.append([row[0],row[1]])
                designids = []
                stconc = None
                for value in DesignbulkPlotids:
                        stconc = "(SECTORTPSSNUMBER = '" + value[0] + "' AND PLOTNUMBER = '" + value[1] + "')"
                        designids.append(stconc)
                designids = 'or'.join(["{}".format(value) for value in designids])
                PLOTDESIGN_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOTDESIGN_Adjustment.lyr")
                if Plot == "Bulk":
                        PLOTDESIGN_Adjustment.definitionQuery = "(" + designids + ") and EXTENSIONTYPE LIKE 'X%'" 
                if Plot <> "Bulk":
                        PLOTDESIGN_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Adjustment, "BOTTOM")
        if OPERATION_TYPE == "Gap Adjustment":
                dCursor = arcpy.da.SearchCursor(LayersPath + "\\" + "NewPlots.lyr",["SECTORTPSSNUMBER","PLOTNUMBER"],"REQNUM = '" + REQNUM + "'")
                DesignbulkPlotids = []
                for row in dCursor:
                        DesignbulkPlotids.append([row[0],row[1]])
                designids = []
                stconc = None
                for value in DesignbulkPlotids:
                        stconc = "(SECTORTPSSNUMBER = '" + value[0] + "' AND PLOTNUMBER = '" + value[1] + "')"
                        designids.append(stconc)
                designids = 'or'.join(["{}".format(value) for value in designids])
                PLOTDESIGN_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOTDESIGN_Adjustment.lyr")
                if Plot == "Bulk":
                        PLOTDESIGN_Adjustment.definitionQuery = "(" + designids + ") and EXTENSIONTYPE LIKE 'G%'"
                if Plot <> "Bulk":
                        PLOTDESIGN_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Adjustment, "BOTTOM")
        #===========================================================================================================
        V_NEWPLOTS_VISIBILITY = arcpy.mapping.ListTableViews(mxd,"V_NEWPLOTS_VISIBILITY")[0]
        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 0 AND FEATURE_LAYER = 'FGDABEDITZ40.PLOT'")
        PLOTINTERNALID = []

        for row in sorted(sCursor):
            PLOTINTERNALID.append(row[0])
        PLOTINTERNALID = ','.join(["'{}'".format(value) for value in PLOTINTERNALID])

        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 1 AND FEATURE_LAYER = 'FGDABEDITZ40.PLOTDESIGN'")
        PlotDesignInternalID = []

        for row in sorted(sCursor):
            PlotDesignInternalID.append(row[0])

        PlotDesignInternalID = ','.join(["'{}'".format(value) for value in PlotDesignInternalID])

        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 1 AND FEATURE_LAYER = 'FGDABEDITZ40.PROPOSED_PLOT'")
        PlotProposedInternalID = []

        for row in sorted(sCursor):
            PlotProposedInternalID.append(row[0])

        PlotProposedInternalID = ','.join(["'{}'".format(value) for value in PlotProposedInternalID])

        #===========================================================================================================
        lyname = "PLOT"
        if lyname in lylist:
                if OPERATION_TYPE == "Plot Adjustment":
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")
                elif OPERATION_TYPE == "Plot Shifting":
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")
                else:
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")

        #===========================================================================================================
        lyname = "NewPlots"
        if lyname in lylist:
                if PLOTBNDRY_DASHED <> "1":
                        NewPlotsType_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlotsType.lyr")
                        NewPlotsType_Layer.definitionQuery = "REQNUM = '" + REQNUM + "' AND EXTTYPE = 'P'"
                        arcpy.mapping.AddLayer(pDataFrame, NewPlotsType_Layer, "BOTTOM")

        lyname = "PROPOSED_PLOT"
        if lyname in lylist:
                PROPOSED_PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if PlotProposedInternalID <> "":
                        PROPOSED_PLOT_Layer.definitionQuery = "(PLOTINTERNALID IN (" + PlotProposedInternalID + "))"
                arcpy.mapping.AddLayer(pDataFrame, PROPOSED_PLOT_Layer, "BOTTOM")

        lyname = "PlotDesign"
        if lyname in lylist:
                PLOTDESIGN_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if PlotDesignInternalID <> "":
                        PLOTDESIGN_Layer.definitionQuery = "(PLOTDESIGNID IN (" + PlotDesignInternalID + "))"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Layer, "BOTTOM")
                         
        lyname = "NewPlots"
        if lyname in lylist:
                if PLOTBNDRY_DASHED <> "1":
                        NewPlots_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlots.lyr")
                        if NewPlots_Layer.supports("LABELCLASSES"):
                                if NewPlots_Layer.showLabels:
                                        for lblClass in NewPlots_Layer.labelClasses:
                                                if lblClass.className == "Default":
                                                        #if lblClass.showClassLabels:
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOT_LABEL) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                                                if lblClass.className == "Extension":
                                                        #if lblClass.showClassLabels:
                                                        extar = u"Ã“¡ „÷«›"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ extar +"</FNT>\""
                                                if lblClass.className == "GAP":
                                                        #if lblClass.showClassLabels:
                                                        gapar = u"÷„ ›«’·"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ gapar + "</FNT>\""
                                                if lblClass.className == "CUT":
                                                        #if lblClass.showClassLabels:
                                                        cutar = u"Ã“¡ „” ﬁÿ⁄"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ cutar +"</FNT>\""
                        NewPlots_Layer.definitionQuery = "REQNUM = '" + REQNUM + "'"
                        if satelliteexist is not None:
                                NewPlots_Layer.transparency = 40
                        arcpy.mapping.AddLayer(pDataFrame, NewPlots_Layer, "BOTTOM")
                else:
                        NewPlots_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlots_Dashed.lyr")
                        if NewPlots_Layer.supports("LABELCLASSES"):
                                if NewPlots_Layer.showLabels:
                                        for lblClass in NewPlots_Layer.labelClasses:
                                                if lblClass.className == "Default":
                                                        #if lblClass.showClassLabels:
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOT_LABEL) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                                                if lblClass.className == "Extension":
                                                        #if lblClass.showClassLabels:
                                                        extar = u"Ã“¡ „÷«›"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ extar +"</FNT>\""
                                                if lblClass.className == "GAP":
                                                        #if lblClass.showClassLabels:
                                                        gapar = u"÷„ ›«’·"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ gapar + "</FNT>\""
                                                if lblClass.className == "CUT":
                                                        #if lblClass.showClassLabels:
                                                        cutar = u"Ã“¡ „” ﬁÿ⁄"
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOTEXTN_FONTSIZE) +"'>"+ cutar +"</FNT>\""
                        NewPlots_Layer.definitionQuery = "REQNUM = '" + REQNUM + "'"
                        arcpy.mapping.AddLayer(pDataFrame, NewPlots_Layer, "BOTTOM")

        #===========================================================================================================
        arcpy.AddMessage("Setting map extent and scale")
        #-----------------------------------------------------------------------------------------------------------
        pExtent= arcpy.Extent(MAP_XMIN,MAP_YMIN,MAP_XMAX,MAP_YMAX)
        pExtent.spatialReference = pSpatialReference
        pDataFrame.extent = pExtent
        if Scale <> "":
                pDataFrame.scale = Scale
        #===========================================================================================================
        lyname = "PLANNED_ROAD_EDGE_SML"
        if lyname in lylist:
                PLANNED_ROAD_EDGE_SML_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_EDGE_SML_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_CENTRE_LINE_SML"
        if lyname in lylist:
                PLANNED_ROAD_CENTRE_LINE_SML_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_CENTRE_LINE_SML_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_EDGE"
        if lyname in lylist:
                PLANNED_ROAD_EDGE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_EDGE_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_CENTRE_LINE"
        if lyname in lylist:
                PLANNED_ROAD_CENTRE_LINE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_CENTRE_LINE_Layer, "BOTTOM")

        lyname = "ROAD_EDGE"
        if lyname in lylist:
                ROAD_EDGE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ROAD_EDGE_Layer, "BOTTOM")

        lyname = "ROAD_CENTRE_LINE"
        if lyname in lylist:
                ROAD_CENTRE_LINE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ROAD_CENTRE_LINE_Layer, "BOTTOM")

        lyname = "ZONE"
        if lyname in lylist:
                ZONE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ZONE_Layer, "BOTTOM")

        lyname = "SECTOR"
        if lyname in lylist:
                SECTOR_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, SECTOR_Layer, "BOTTOM")

        lyname = "SERVICE_CORRIDOR"
        if lyname in lylist:
                SERVICE_CORRIDOR_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, SERVICE_CORRIDOR_Layer, "BOTTOM")

        lyname = "SATELLITE2018"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2017"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2019Nov"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2019Ortho"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")
        #===========================================================================================================
        #arcpy.AddMessage("Setting map extent and scale")
        #-----------------------------------------------------------------------------------------------------------
        #pExtent= arcpy.Extent(MAP_XMIN,MAP_YMIN,MAP_XMAX,MAP_YMAX)
        #pExtent.spatialReference = pSpatialReference
        #pDataFrame.extent = pExtent
        #pDataFrame.scale = (round(pDataFrame.scale / 25) + 1) * 25
        #if Scale <> "":
                #mxd.activeView=pDataFrame.name
                #pDataFrame.scale = Scale
                #mxd.activeView='PAGE_LAYOUT'
                #arcpy.RefreshActiveView()
##                m = float(Scale)
##                n = 250.0
##                r = m % n
##                if r > n / 2.0:
##                    m = n * math.ceil(m / n)
##                elif r <= n / 2.0:
##                    m = n * math.floor(m / n)
##                pDataFrame.scale = m
                #pDataFrame.scale = (round(pDataFrame.scale / 25) + 1) * 25
        #===========================================================================================================
        #arcpy.AddMessage("Getting plots Info")
##        searchcursor = arcpy.SearchCursor(r"Database Connections\GISTEST (SDDSPS).sde\SDDSPS.NEWPLOTS","REQNUM = '" + REQNUM + "'")
##        for row in searchcursor:
##                Zone = row.getValue("ZONENAMEENG")
##                Sector = row.getValue("SECTORTPSSNUMBER")
##                Plot = row.getValue("PLOTNUMBER")
        #===========================================================================================================        

        #===========================================================================================================
        #arcpy.AddMessage("Getting SM DELETED PLOTS INFO")
        #-----------------------------------------------------------------------------------------------------------
        #===========================================================================================================
        arcpy.AddMessage("Getting Sitemap Coordinates")
        #-----------------------------------------------------------------------------------------------------------
        pCursor = arcpy.da.SearchCursor(LayersPath + "\\" + "NP_Points.lyr",["POINT_NUMBER_FINAL","POINT_X","POINT_Y"],"WORKREQUEST = '" + REQNUM + "' AND POINT_NUMBER_VISIBLE = 1")
        #-----------------------------------------------------------------------------------------------------------
        pCoordinates = []
        for row in sorted(pCursor):
                pCoordinates.insert(len(pCoordinates),[int(row[0]),row[1],row[2]])
        #-----------------------------------------------------------------------------------------------------------
        pCoordinates = sorted(pCoordinates)
        #===========================================================================================================	
        arcpy.AddMessage("Setting Sitemap Info")
        #-----------------------------------------------------------------------------------------------------------
        tenantElem = None
        beneElem = None
        donorElem = None
        tenantlabel = None
        beneLabel = None
        donorLabel = None
        for elm in arcpy.mapping.ListLayoutElements(mxd, "TEXT_ELEMENT"):
                if elm.name == "SiteMapID":
                        if REQNUM is None: elm.text = " "
                        else: elm.text = REQNUM	   
                if elm.name == "TheDate":
                        if TheDate is None: elm.text = " "
                        else:elm.text = TheDate                           
                if elm.name == "Request":
                        if REQUEST_BY is None: elm.text = " "
                        else: elm.text = REQUEST_BY	   
                if elm.name == "RequestNo":
                        if LETTER_NO is None: elm.text = " "
                        else: elm.text = LETTER_NO	   
                if elm.name == "RequestDate":
                        if LETTER_DATE is None: elm.text = " "
                        else: elm.text = LETTER_DATE	   
                if elm.name == "Notes":
                        if REMARKS is None: elm.text = " "
                        else:
                                REMARKS = REMARKS.replace("\n","\\n")
                                REMARKS = REMARKS.replace(":(",":-(")
                                if(REMARKS_FONTSIZE is not None and REMARKS_FONTSIZE <> 0):
                                        elm.fontSize = REMARKS_FONTSIZE
                                elm.text = REMARKS
                                #elm.fontSize = int(REMARKS_FONTSIZE)
                                #elm.text = REMARKS
                                #REMARKS = REMARKS.replace("(","")
                                #REMARKS = REMARKS.replace(")","")
##                                lengthofremarks = len(REMARKS)
##                                if (lengthofremarks > 950 and lengthofremarks < 999):
##                                        elm.fontSize = 8
##                                        elm.text = REMARKS
##                                elif (lengthofremarks > 999 and lengthofremarks < 1015): 
##                                        elm.fontSize = 6
##                                        elm.text = REMARKS
##                                else:
##                                        elm.text = REMARKS
                                
                        
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++
                if elm.name == "Zone":	
                        if Zone is None: elm.text = " "
                        else:
                                if(ZONE_FONTSIZE is not None and ZONE_FONTSIZE <> 0):
                                        elm.fontSize = ZONE_FONTSIZE
                                if Zone == "Bulk":
                                        elm.text = "Õ”» «·ÃœÊ· «·„—›ﬁ"
                                else:
                                        elm.text = Zone
                if elm.name == "Sector":	
                        if Sector is None: elm.text = " "
                        else:
                                if(SECTOR_FONTSIZE is not None and SECTOR_FONTSIZE <> 0):
                                        elm.fontSize = SECTOR_FONTSIZE
                                if Sector == "Bulk":
                                        elm.text = "Õ”» «·ÃœÊ· «·„—›ﬁ"
                                else:
                                        elm.text = Sector
                if elm.name == "Plot":	
                        if Plot is None: elm.text = " "
                        else:
                                if(PLOTNUMBER_SIZE is not None and PLOTNUMBER_SIZE <> 0):
                                        elm.fontSize = PLOTNUMBER_SIZE
                                if Plot == "Bulk":
                                        elm.text = "Õ”» «·ÃœÊ· «·„—›ﬁ"
                                else:
                                        elm.text = Plot                                
                if elm.name == "PlotUse":	
                        if PlotUse is None: elm.text = " "
                        else:
                                if(LANDTYPE_FONTSIZE is not None and LANDTYPE_FONTSIZE <> 0):
                                        elm.fontSize = LANDTYPE_FONTSIZE
                                if DMT_PRINT_USAGE == "1":
                                        if(ALLOCATIONTYPE_DM is not None and PURPOSEOFUSE is not None):
                                                elm.text = str(ALLOCATIONTYPE_DM) + "/" + str(PURPOSEOFUSE)
                                        else: elm.text = " "
                                else:       
                                        elm.text = PlotUse
                if elm.name == "OwnerName":	
                        if OwnerName is None: elm.text = " "
                        else: elm.text = OwnerName
                if elm.name == "Action":	
                        if purpose is None: elm.text = " "
                        else:
                                if(ACTION_FONTSIZE is not None and ACTION_FONTSIZE <> 0):
                                        elm.fontSize = ACTION_FONTSIZE
                                elm.text = purpose
                if elm.name == "Tenant":
                        tenantElem = elm
                        if Tenant is None: elm.text = " "
##                        if Tenant is None:
##                                if BENEFICIARY is not None:
##                                        elm.text = BENEFICIARY
##                                if BENEFICIARY is None:
##                                        if PAYEE is not None:
##                                                elm.text = PAYEE
##                                        else:
##                                                elm.text = " "
##                        else: elm.text = Tenant
                if elm.name == "Tenant_Label":
                        tenantlabel = elm
                        if Tenant is None: elm.text = " "
                if elm.name == "Beneficiary_Label":
                        beneLabel = elm
                if elm.name == "Payee_Label":
                        donorLabel = elm
##                        if Tenant is None:
##                                if BENEFICIARY is not None:
##                                        elm.text = "«·„” ›Ìœ"
##                                if BENEFICIARY is None:
##                                        if PAYEE is not None:
##                                                elm.text = "⁄·Ï ‰›ﬁ…"
##                                        else:
##                                                elm.text = " "
##                        else: elm.text = "«·„” √Ã—"
                if elm.name == "CutAreaSqrFt":	
                        if CUTAREAF is None: elm.text = " "
                        else: elm.text = str(CUTAREAF) + " " + "Sqft"
                if elm.name == "CutAreaSqrM":	
                        if CUTAREAM is None: elm.text = " "
                        else: elm.text = str(CUTAREAM) + " " + "Sqm"
                if elm.name == "AddAreaSqrFt":	
                        if EXTAREAF is None: elm.text = " "
                        else: elm.text = str(EXTAREAF) + " " + "Sqft"
                if elm.name == "AddAreaSqrM":	
                        if EXTAREAM is None: elm.text = " "
                        else: elm.text = str(EXTAREAM) + " " + "Sqm"
                if elm.name == "AreaSqrM":	
                        if PLOTAREAM is None: elm.text = " "
                        else: elm.text =  str(PLOTAREAM) + " " + "Sqm"
                if elm.name == "AreaSqrFt":	
                        if PLOTAREAF is None: elm.text = " "
                        else: elm.text = str(PLOTAREAF) + " " + "Sqft" 
                if elm.name == "APPROVEDBY":	
                        if MSQ_APPROVEDBY is None: elm.text = " "
                        else: elm.text = MSQ_APPROVEDBY
                if elm.name == "UPDAPPROVALLETTERNO":	
                        if UPD_LETTER_NO is None: elm.text = " "
                        else: elm.text = UPD_LETTER_NO
                if elm.name == "UPDAPPDATE":	
                        if UPD_LETTER_DATE is None: elm.text = " "
                        else: elm.text = UPD_LETTER_DATE
                if elm.name == "APPROVALLETTERNO":	
                        if MSQ_LETTERNO is None: elm.text = " "
                        else: elm.text = MSQ_LETTERNO
                if elm.name == "APPROVALLETTERDATE":	
                        if MSQ_LLETTERDATE is None: elm.text = " "
                        else: elm.text = MSQ_LLETTERDATE
                if elm.name == "DONATORNAME":	
                        if DONATORNAME is None: elm.text = " "
                        else: elm.text = DONATORNAME
                if elm.name == "MOSQUECAPACITY":	
                        if MOSQUECAPACITY is None: elm.text = " "
                        else: elm.text = MOSQUECAPACITY
                if elm.name == "Period":	
                        if Period is None: elm.text = " "
                        else: elm.text = Period
                if elm.name == "CopyTo":	
                        if CopyTo == "0": elm.text = " "
##                        else: elm.text = CopyTo
                if elm.name == "UserName":	
                        if UserName is None: elm.text = " "
                        else: elm.text = UserName
                if elm.name == "TemplateName":
                        if TempalteName is None: elm.text = " "
                        else: elm.text = TempalteName
                if elm.name == "Benficiary":
                        beneElem = elm
                if elm.name == "Payee":
                        donorElem = elm
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++
                if elm.name == "P1":	
                        if len(pCoordinates) < 1: elm.text = " "
                        else: elm.text = pCoordinates[0][0]
                if elm.name == "P2":	
                        if len(pCoordinates) < 2: elm.text = " "
                        else: elm.text = pCoordinates[1][0]
                if elm.name == "P3":	
                        if len(pCoordinates) < 3: elm.text = " "
                        else: elm.text = pCoordinates[2][0]
                if elm.name == "P4":	
                        if len(pCoordinates) < 4: elm.text = " "
                        else: elm.text = pCoordinates[3][0]
                if elm.name == "P5":	
                        if len(pCoordinates) < 5: elm.text = " "
                        else: elm.text = pCoordinates[4][0]
                if elm.name == "P6":	
                        if len(pCoordinates) < 6: elm.text = " "
                        else: elm.text = pCoordinates[5][0]
                if elm.name == "P7":	
                        if len(pCoordinates) < 7: elm.text = " "
                        else: elm.text = pCoordinates[6][0]
                if elm.name == "P8":	
                        if len(pCoordinates) < 8: elm.text = " "
                        else: elm.text = pCoordinates[7][0]
                if elm.name == "P9":	
                        if len(pCoordinates) < 9: elm.text = " "
                        else: elm.text = pCoordinates[8][0]
                if elm.name == "P10":	
                        if len(pCoordinates) < 10: elm.text = " "
                        else: elm.text = pCoordinates[9][0]
                if elm.name == "P11":	
                        if len(pCoordinates) < 11: elm.text = " "
                        else: elm.text = pCoordinates[10][0]
                if elm.name == "P12":	
                        if len(pCoordinates) < 12: elm.text = " "
                        else: elm.text = pCoordinates[11][0]
                if elm.name == "P13":	
                        if len(pCoordinates) < 13: elm.text = " "
                        else: elm.text = pCoordinates[12][0]
                if elm.name == "P14":	
                        if len(pCoordinates) < 14: elm.text = " "
                        else: elm.text = pCoordinates[13][0]
                if elm.name == "P15":	
                        if len(pCoordinates) < 15: elm.text = " "
                        else: elm.text = pCoordinates[14][0]
                if elm.name == "P16":	
                        if len(pCoordinates) < 16: elm.text = " "
                        else: elm.text = pCoordinates[15][0]
                if elm.name == "P17":	
                        if len(pCoordinates) < 17: elm.text = " "
                        else: elm.text = pCoordinates[16][0]
                if elm.name == "P18":	
                        if len(pCoordinates) < 18: elm.text = " "
                        else: elm.text = pCoordinates[17][0]
                if elm.name == "P19":	
                        if len(pCoordinates) < 19: elm.text = " "
                        else: elm.text = pCoordinates[18][0]
                if elm.name == "P20":	
                        if len(pCoordinates) < 20: elm.text = " "
                        else: elm.text = pCoordinates[19][0]
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++ 
                if elm.name == "X1":	
                        if len(pCoordinates) < 1: elm.text = " "
                        else: elm.text = pCoordinates[0][1]
                if elm.name == "X2":	
                        if len(pCoordinates) < 2: elm.text = " "
                        else: elm.text = pCoordinates[1][1]
                if elm.name == "X3":	
                        if len(pCoordinates) < 3: elm.text = " "
                        else: elm.text = pCoordinates[2][1]
                if elm.name == "X4":	
                        if len(pCoordinates) < 4: elm.text = " "
                        else: elm.text = pCoordinates[3][1]
                if elm.name == "X5":	
                        if len(pCoordinates) < 5: elm.text = " "
                        else: elm.text = pCoordinates[4][1]
                if elm.name == "X6":	
                        if len(pCoordinates) < 6: elm.text = " "
                        else: elm.text = pCoordinates[5][1]
                if elm.name == "X7":	
                        if len(pCoordinates) < 7: elm.text = " "
                        else: elm.text = pCoordinates[6][1]
                if elm.name == "X8":	
                        if len(pCoordinates) < 8: elm.text = " "
                        else: elm.text = pCoordinates[7][1]
                if elm.name == "X9":	
                        if len(pCoordinates) < 9: elm.text = " "
                        else: elm.text = pCoordinates[8][1]
                if elm.name == "X10":	
                        if len(pCoordinates) < 10: elm.text = " "
                        else: elm.text = pCoordinates[9][1]
                if elm.name == "X11":	
                        if len(pCoordinates) < 11: elm.text = " "
                        else: elm.text = pCoordinates[10][1]
                if elm.name == "X12":	
                        if len(pCoordinates) < 12: elm.text = " "
                        else: elm.text = pCoordinates[11][1]
                if elm.name == "X13":	
                        if len(pCoordinates) < 13: elm.text = " "
                        else: elm.text = pCoordinates[12][1]
                if elm.name == "X14":	
                        if len(pCoordinates) < 14: elm.text = " "
                        else: elm.text = pCoordinates[13][1]
                if elm.name == "X15":	
                        if len(pCoordinates) < 15: elm.text = " "
                        else: elm.text = pCoordinates[14][1]
                if elm.name == "X16":	
                        if len(pCoordinates) < 16: elm.text = " "
                        else: elm.text = pCoordinates[15][1]
                if elm.name == "X17":	
                        if len(pCoordinates) < 17: elm.text = " "
                        else: elm.text = pCoordinates[16][1]
                if elm.name == "X18":	
                        if len(pCoordinates) < 18: elm.text = " "
                        else: elm.text = pCoordinates[17][1]
                if elm.name == "X19":	
                        if len(pCoordinates) < 19: elm.text = " "
                        else: elm.text = pCoordinates[18][1]
                if elm.name == "X20":	
                        if len(pCoordinates) < 20: elm.text = " "
                        else: elm.text = pCoordinates[19][1]
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++
                if elm.name == "Y1":	
                        if len(pCoordinates) < 1: elm.text = " "
                        else: elm.text = pCoordinates[0][2]
                if elm.name == "Y2":	
                        if len(pCoordinates) < 2: elm.text = " "
                        else: elm.text = pCoordinates[1][2]
                if elm.name == "Y3":	
                        if len(pCoordinates) < 3: elm.text = " "
                        else: elm.text = pCoordinates[2][2]
                if elm.name == "Y4":	
                        if len(pCoordinates) < 4: elm.text = " "
                        else: elm.text = pCoordinates[3][2]
                if elm.name == "Y5":	
                        if len(pCoordinates) < 5: elm.text = " "
                        else: elm.text = pCoordinates[4][2]
                if elm.name == "Y6":	
                        if len(pCoordinates) < 6: elm.text = " "
                        else: elm.text = pCoordinates[5][2]
                if elm.name == "Y7":	
                        if len(pCoordinates) < 7: elm.text = " "
                        else: elm.text = pCoordinates[6][2]
                if elm.name == "Y8":	
                        if len(pCoordinates) < 8: elm.text = " "
                        else: elm.text = pCoordinates[7][2]
                if elm.name == "Y9":	
                        if len(pCoordinates) < 9: elm.text = " "
                        else: elm.text = pCoordinates[8][2]
                if elm.name == "Y10":	
                        if len(pCoordinates) < 10: elm.text = " "
                        else: elm.text = pCoordinates[9][2]
                if elm.name == "Y11":	
                        if len(pCoordinates) < 11: elm.text = " "
                        else: elm.text = pCoordinates[10][2]
                if elm.name == "Y12":	
                        if len(pCoordinates) < 12: elm.text = " "
                        else: elm.text = pCoordinates[11][2]
                if elm.name == "Y13":	
                        if len(pCoordinates) < 13: elm.text = " "
                        else: elm.text = pCoordinates[12][2]
                if elm.name == "Y14":	
                        if len(pCoordinates) < 14: elm.text = " "
                        else: elm.text = pCoordinates[13][2]
                if elm.name == "Y15":	
                        if len(pCoordinates) < 15: elm.text = " "
                        else: elm.text = pCoordinates[14][2]
                if elm.name == "Y16":	
                        if len(pCoordinates) < 16: elm.text = " "
                        else: elm.text = pCoordinates[15][2]
                if elm.name == "Y17":	
                        if len(pCoordinates) < 17: elm.text = " "
                        else: elm.text = pCoordinates[16][2]
                if elm.name == "Y18":	
                        if len(pCoordinates) < 18: elm.text = " "
                        else: elm.text = pCoordinates[17][2]
                if elm.name == "Y19":	
                        if len(pCoordinates) < 19: elm.text = " "
                        else: elm.text = pCoordinates[18][2]
                if elm.name == "Y20":	
                        if len(pCoordinates) < 20: elm.text = " "
                        else: elm.text = pCoordinates[19][2]
        if Tenant is not None:
                if tenantElem <> None:
                        tenantElem.text = Tenant
                        tenantlabel.text = "«·„” √Ã—"
                if BENEFICIARY is not None :
                      if beneElem <> None:
                              beneElem.text = BENEFICIARY
                              beneLabel.text = "«·„‰ ›⁄"
                      if PAYEE is not None:
                              if donorElem <> None:
                                      donorElem.text = PAYEE
                                      donorLabel.text = "⁄·Ï ‰›ﬁ…"
                else:
                        if beneElem <> None:
                                if PAYEE is not None:
                                        beneElem.text = PAYEE
                                        beneLabel.text = "⁄·Ï ‰›ﬁ…"
                
        else:               
                if BENEFICIARY is not None :
                        if tenantElem <> None:
                                tenantElem.text = BENEFICIARY
                                tenantlabel.text = "«·„‰ ›⁄"
                        if PAYEE is not None:
                                if beneElem <> None:
                                        beneElem.text = PAYEE
                                        beneLabel.text = "⁄·Ï ‰›ﬁ…"
                else:
                        if PAYEE is not None:
                                if tenantElem <> None:
                                        tenantElem.text = PAYEE
                                        tenantlabel.text = "⁄·Ï ‰›ﬁ…"
                
                
        #===========================================================================================================
        arcpy.AddMessage("Setting QR Code Image")
        #-----------------------------------------------------------------------------------------------------------
        if not os.path.exists(os.path.dirname(ARCHIVE_PATH)):
                os.makedirs(os.path.dirname(ARCHIVE_PATH))
        #===========================================================================================================
        arcpy.AddMessage("Exporting SITEMAP to PDF")
        #-----------------------------------------------------------------------------------------------------------
        mxd.saveACopy(ARCHIVE_PATH + REQNUM + "_AP" + ".mxd")
        arcpy.mapping.ExportToPDF(mxd, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF",resolution=600,embed_fonts=True, image_quality="NORMAL")
        arcpy.SetParameterAsText(2, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF")
        arcpy.SetParameterAsText(3, "Success")
else:
        arcpy.SetParameterAsText(3, "Failure")



      beneLabel.text = "⁄·Ï ‰›ﬁ…"
                
        else:               
                if BENEFICIARY is not None :
                        if tenantElem <> None:
                                tenantElem.text = BENEFICIARY
                                tenantlabel.text = "«·„‰ ›⁄"
                        if PAYEE is not None:
                                if beneElem <> None:
                                        beneElem.text = PAYEE
                                        beneLabel.text = "⁄·Ï ‰›ﬁ…"
                else:
                        if PAYEE is not None:
                                if tenantElem <> None:
                                        tenantElem.text = PAYEE
                                        tenantlabel.text = "⁄·Ï ‰›ﬁ…"
                
                
        #===========================================================================================================
        arcpy.AddMessage("Setting QR Code Image")
        #-----------------------------------------------------------------------------------------------------------
        if not os.path.exists(os.path.dirname(ARCHIVE_PATH)):
                os.makedirs(os.path.dirname(ARCHIVE_PATH))
        #===========================================================================================================
        arcpy.AddMessage("Exporting SITEMAP to PDF")
        #-----------------------------------------------------------------------------------------------------------
        mxd.saveACopy(ARCHIVE_PATH + REQNUM + "_AP" + ".mxd")
        arcpy.mapping.ExportToPDF(mxd, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF",resolution=600,embed_fonts=True, image_quality="NORMAL")
        arcpy.SetParameterAsText(2, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF")
        arcpy.SetParameterAsText(3, "Success")
else:
        arcpy.SetParameterAsText(3, "Failure")



eterAsText(3, "Failure")



len(SM_PLOTS) < 37: elm.delete()
                        else: elm.text = SM_PLOTS[36][11]
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++
                if elm.name == "GAP_PLOT":
                        if len(SM_PLOTS) > 37: elm.delete()
                if elm.name == "GAP_PLOT_1":
                        if len(SM_PLOTS) < 1: elm.delete()
                        else: elm.text = SM_PLOTS[0][10]	   
                if elm.name == "GAP_PLOT_2":
                        if len(SM_PLOTS) < 2: elm.delete()
                        else: elm.text = SM_PLOTS[1][10]	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   