import arcpy
import datetime
import uuid
import os
import numpy
import matplotlib.pyplot as plt
#===========================================================================================================
arcpy.env.overwriteOutput = True
#===========================================================================================================
arcpy.AddMessage("Collecting input parameters")
#-----------------------------------------------------------------------------------------------------------
REQNUM = arcpy.GetParameterAsText(0)
TempalteName = arcpy.GetParameterAsText(1)
templaterows = arcpy.GetParameterAsText(4)
Scale = arcpy.GetParameterAsText(5)
Excel = arcpy.GetParameterAsText(6)
#Legend = arcpy.GetParameterAsText(7)
#===========================================================================================================
arcpy.AddMessage("Loading MapDocument")
#-----------------------------------------------------------------------------------------------------------
DocumentPath = r"//AD007APP06/gisapplications/gisapps/sddsps/Templates/" + TempalteName +  ".mxd"

mxd = arcpy.mapping.MapDocument(DocumentPath)
pDataFrame = arcpy.mapping.ListDataFrames(mxd, "Layers")[0]
pSpatialReference = pDataFrame.spatialReference
#===========================================================================================================
arcpy.AddMessage("Getting Sitemap Info")
#-----------------------------------------------------------------------------------------------------------
V_SM_FULL_INFO = arcpy.mapping.ListTableViews(mxd,"V_SM_FULL_INFO")[0]
pCursor = arcpy.da.SearchCursor(V_SM_FULL_INFO, "*" ,"REQNUM = '" + REQNUM + "'")
intcount = 0
for row in pCursor:
        intcount += 1
        OwnerName = row[2]
        Tenant = row[3]
        TheDate = row[4]
        TRANSACTION_DESCRIPTION_ARA = row[5]
        REQUEST_BY = row[6]
        LETTER_NO = row[7]
        LETTER_DATE = row[8]
        OWNER_LABEL = row[9]
        TENANT_LABEL = row[10]
        BENEFICIARY_LABEL = row[11]
        REMARKS = row[12]
        DRAFTSMAN_NAME = row[15]
        MAP_ANGLE = row[22]
        MAP_XMIN = row[23]
        MAP_YMIN = row[24]
        MAP_XMAX = row[25]
        MAP_YMAX = row[26]
        TMP_RENTSTARTDATE = row[27]
        TMP_RENTENDDATE = row[28]
        TMP_RENTENDDETAILS = row[29]
        MSQ_APPROVEDBY = row[30]
        MSQ_LETTERNO = row[31]
        MSQ_LLETTERDATE = row[32]
        DONATORNAME = row[33]
        MOSQUECAPACITY = row[34]
        UPD_LETTER_NO = row[35]
        UPD_LETTER_DATE = row[36]
        SURVEY_REPORT_NO = row[37]
        SURVEY_REPORT_DATE = row[38]
        CopyTo = row[39]
        ARCHIVE_PATH = row[41]
        LayersPath = row[43]
        PLOTAREAM = row[45]
        PLOTAREAF = row[46]
        CUTAREAM = row[47]
        CUTAREAF = row[48]
        EXTAREAM =row[49]
        EXTAREAF = row[50]
        PlotUse = row[51]
        UserName = row[54]
        BENEFICIARY = row[55]
        PAYEE = row[56]
        purpose = row[57]
        Zone = row[58]
        Sector = row[59]
        Plot = row[60]
        OPERATION_TYPE = row[61]
        IS_SRVC_PAYABLE = row[63]
        SMFOREN = row[70]
        REMARKS_FONTSIZE = row[72]
        LANDTYPE_FONTSIZE = row[73]
        ACTION_FONTSIZE = row[76]
        PLOT_LABEL = row[77]
        DIMENSIONS_FONTSIZE = row[82]
        SURRONDED_PLOTS_FONTSIZE = row[83]
        ZONE_FONTSIZE = row[84]
        SECTOR_FONTSIZE = row[85]
if intcount <> 0:
        #===========================================================================================================
        arcpy.AddMessage("Adding Map Layers")
        #-----------------------------------------------------------------------------------------------------------
        pDataFrame.rotation = MAP_ANGLE

        #if Plot == "Bulk":
        V_BULKREQUEST_PLOTINTERNALIDS = arcpy.mapping.ListTableViews(mxd,"V_BULKREQUEST_PLOTINTERNALIDS")[0]
        nCursor = arcpy.da.SearchCursor(V_BULKREQUEST_PLOTINTERNALIDS,["PLOTINTERNALID"],"REQNUM = '" + REQNUM + "'")
        BulkPlotids = []
        for row in nCursor:
                BulkPlotids.append(row[0])
        BulkPlotids = ','.join(["'{}'".format(value) for value in BulkPlotids])
        
        V_SM_LAYERS_TOSHOW = arcpy.mapping.ListTableViews(mxd,"V_SM_LAYERS_TOSHOW")[0]
        searchcursor = arcpy.da.SearchCursor(V_SM_LAYERS_TOSHOW, "*" ,"REQNUM = '" + REQNUM + "'")
        lylist = []
        for row in searchcursor:
                lyname = row[2]
                lylist.append(lyname)

        satelliteexist = None
        lyname = "SATELLITE2018"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2017"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2019Nov"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "SATELLITE2019Ortho"
        if lyname in lylist:
                satelliteexist = lyname

        lyname = "NP_Centroid"
        if lyname in lylist:
                NP_Centroid_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                NP_Centroid_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "'"
                arcpy.mapping.AddLayer(pDataFrame, NP_Centroid_Layer, "BOTTOM")
        lyname = "NP_Points"
        if lyname in lylist:
                NP_Points_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + "_A3.lyr")
                NP_Points_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "' AND POINT_NUMBER_VISIBLE = 1"
                arcpy.mapping.AddLayer(pDataFrame, NP_Points_Layer, "BOTTOM")
        lyname = "NP_Dimensions"
        if lyname in lylist:
                NP_Dimensions_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if NP_Dimensions_Layer.supports("LABELCLASSES"):
                                if NP_Dimensions_Layer.showLabels:
                                        for lblClass in NP_Dimensions_Layer.labelClasses:
                                                if lblClass.className == "PLOT":
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(DIMENSIONS_FONTSIZE) +"'>\" & [D_LENGTH] & \"</FNT>\""
                NP_Dimensions_Layer.definitionQuery = "WORKREQUEST = '" + REQNUM + "'AND D_LENGTH_VISIBLE = 1"
                arcpy.mapping.AddLayer(pDataFrame, NP_Dimensions_Layer, "BOTTOM")
        #===========================================================================================================
        lyname = "OldBoundary_NoLabel"
        if lyname in lylist:
                OldBoundary_NoLabel = arcpy.mapping.Layer(LayersPath + "\\" + "OldBoundary_NoLabel.lyr")
                if Plot == "Bulk":
                        OldBoundary_NoLabel.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                if Plot <> "Bulk":
                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                        OldBoundary_NoLabel.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                arcpy.mapping.AddLayer(pDataFrame, OldBoundary_NoLabel, "BOTTOM")

        lyname = "OldBoundary"
        if lyname in lylist:
                OldBoundary = arcpy.mapping.Layer(LayersPath + "\\" + "OldBoundary.lyr")
                if Plot == "Bulk":
                        OldBoundary.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                if Plot <> "Bulk":
                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
                        OldBoundary.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
                arcpy.mapping.AddLayer(pDataFrame, OldBoundary, "BOTTOM")
        #===========================================================================================================
##        if OPERATION_TYPE == "Plot Adjustment":
##                PLOT_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT_Adjustment.lyr")
##                if Plot == "Bulk":
##                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
##                if Plot <> "Bulk":
##                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
##                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
##                arcpy.mapping.AddLayer(pDataFrame, PLOT_Adjustment, "BOTTOM")
##        if OPERATION_TYPE == "Plot Shifting":
##                PLOT_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT_Adjustment.lyr")
##                if Plot == "Bulk":
##                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
##                if Plot <> "Bulk":
##                        #PLOT_Adjustment.definitionQuery = "SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "'"
##                        PLOT_Adjustment.definitionQuery = "(PLOTINTERNALID IN (" + BulkPlotids + "))"
##                arcpy.mapping.AddLayer(pDataFrame, PLOT_Adjustment, "BOTTOM")
        if OPERATION_TYPE == "Plot Extension Adjustment":
                dCursor = arcpy.da.SearchCursor(LayersPath + "\\" + "NewPlots.lyr",["SECTORTPSSNUMBER","PLOTNUMBER","EXTTYPE"],"REQNUM = '" + REQNUM + "' and EXTTYPE LIKE 'X%'")
                DesignbulkPlotids = []
                for row in dCursor:
                        DesignbulkPlotids.append([row[0],row[1],row[2]])
                designids = []
                stconc = None
                for value in DesignbulkPlotids:
                        stconc = "((SECTORTPSSNUMBER = '" + value[0] + "' AND PLOTNUMBER = '" + value[1] + "') AND EXTENSIONTYPE = '" + value[2] + "')" 
                        designids.append(stconc)
                designids = 'or'.join(["{}".format(value) for value in designids])

                PLOTDESIGN_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOTDESIGN_Adjustment.lyr")
                PLOTDESIGN_Adjustment.definitionQuery = "(" + designids + ") and EXTENSIONTYPE LIKE 'X%'"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Adjustment, "BOTTOM")
        if OPERATION_TYPE == "Gap Adjustment":
                dCursor = arcpy.da.SearchCursor(LayersPath + "\\" + "NewPlots.lyr",["SECTORTPSSNUMBER","PLOTNUMBER","EXTTYPE"],"REQNUM = '" + REQNUM + "' and EXTTYPE LIKE 'G%'")
                DesignbulkPlotids = []
                for row in dCursor:
                        DesignbulkPlotids.append([row[0],row[1],row[2]])
                designids = []
                stconc = None
                for value in DesignbulkPlotids:
                        stconc = "((SECTORTPSSNUMBER = '" + value[0] + "' AND PLOTNUMBER = '" + value[1] + "') AND EXTENSIONTYPE = '" + value[2] + "')" 
                        designids.append(stconc)
                designids = 'or'.join(["{}".format(value) for value in designids])

                PLOTDESIGN_Adjustment = arcpy.mapping.Layer(LayersPath + "\\" + "PLOTDESIGN_Adjustment.lyr")
                PLOTDESIGN_Adjustment.definitionQuery = "(" + designids + ") and EXTENSIONTYPE LIKE 'G%'"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Adjustment, "BOTTOM")
        #===========================================================================================================
        V_NEWPLOTS_VISIBILITY = arcpy.mapping.ListTableViews(mxd,"V_NEWPLOTS_VISIBILITY")[0]
        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 0 AND FEATURE_LAYER = 'FGDABEDITZ40.PLOT'")
        PLOTINTERNALID = []

        for row in sorted(sCursor):
            PLOTINTERNALID.append(row[0])
        PLOTINTERNALID = ','.join(["'{}'".format(value) for value in PLOTINTERNALID])

        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 1 AND FEATURE_LAYER = 'FGDABEDITZ40.PLOTDESIGN'")
        PlotDesignInternalID = []

        for row in sorted(sCursor):
            PlotDesignInternalID.append(row[0])

        PlotDesignInternalID = ','.join(["'{}'".format(value) for value in PlotDesignInternalID])

        sCursor = arcpy.da.SearchCursor(V_NEWPLOTS_VISIBILITY, ["PLOTINTERNALID"] ,"REQNUM = '" + REQNUM + "' AND IS_VISIBLE = 1 AND FEATURE_LAYER = 'FGDABEDITZ40.PROPOSED_PLOT'")
        PlotProposedInternalID = []

        for row in sorted(sCursor):
            PlotProposedInternalID.append(row[0])

        PlotProposedInternalID = ','.join(["'{}'".format(value) for value in PlotProposedInternalID])

        #===========================================================================================================
        lyname = "PLOT"
        if lyname in lylist:
                if OPERATION_TYPE == "Plot Adjustment":
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "'))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"

                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "')) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")
                elif OPERATION_TYPE == "Plot Shifting":
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "'))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "')) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")
                else:
                        PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "PLOT.lyr")
                        if PLOT_Layer.supports("LABELCLASSES"):
                                if PLOT_Layer.showLabels:
                                        for lblClass in PLOT_Layer.labelClasses:
                                                lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(SURRONDED_PLOTS_FONTSIZE) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        if PLOTINTERNALID == "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (" + BulkPlotids + "))"
                                                #arcpy.AddMessage("not (PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "'))")
                                                PLOT_Layer.definitionQuery = "not (PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "'))"
                                if Plot <> "Bulk":
                                        PLOT_Layer.definitionQuery = "not(SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "')"
                        if PLOTINTERNALID <> "":
                                if Plot == "Bulk":
                                        if BulkPlotids <> "":
                                                #arcpy.AddMessage("not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))")
                                                #PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + BulkPlotids + ")) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (SELECT PLOTINTERNALID FROM V_BULKREQUEST_PLOTINTERNALIDS where REQNUM ='" + REQNUM + "')) or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                        if BulkPlotids == "":
                                                PLOT_Layer.definitionQuery = "not ((PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                                if Plot <> "Bulk":
                                         PLOT_Layer.definitionQuery = "not ((SECTORTPSSNUMBER = '" + Sector + "' AND PLOTNUMBER = '" + Plot + "') or (PLOTINTERNALID IN (" + PLOTINTERNALID + ")))"
                        arcpy.mapping.AddLayer(pDataFrame, PLOT_Layer, "BOTTOM")
        #===========================================================================================================
        lyname = "NewPlots"
        if lyname in lylist:
                NewPlotsType_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlotsType.lyr")
                NewPlotsType_Layer.definitionQuery = "REQNUM = '" + REQNUM + "' AND EXTTYPE = 'P'"
                arcpy.mapping.AddLayer(pDataFrame, NewPlotsType_Layer, "BOTTOM")

        lyname = "PROPOSED_PLOT"
        if lyname in lylist:
                PROPOSED_PLOT_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if PlotProposedInternalID <> "":
                        PROPOSED_PLOT_Layer.definitionQuery = "(PLOTINTERNALID IN (" + PlotProposedInternalID + "))"
                arcpy.mapping.AddLayer(pDataFrame, PROPOSED_PLOT_Layer, "BOTTOM")

        lyname = "PlotDesign"
        if lyname in lylist:
                PLOTDESIGN_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                if PlotDesignInternalID <> "":
                        PLOTDESIGN_Layer.definitionQuery = "(PLOTDESIGNID IN (" + PlotDesignInternalID + "))"
                arcpy.mapping.AddLayer(pDataFrame, PLOTDESIGN_Layer, "BOTTOM")
                         
        lyname = "NewPlots"
        if lyname in lylist:
                if SMFOREN == "Master Plan":
                        NewPlots_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlotsMasterPlan.lyr")
                        if NewPlots_Layer.supports("LABELCLASSES"):
                                if NewPlots_Layer.showLabels:
                                        for lblClass in NewPlots_Layer.labelClasses:
                                                if lblClass.className == "Default":
                                                #if lblClass.showClassLabels:
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOT_LABEL) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        NewPlots_Layer.definitionQuery = "REQNUM = '" + REQNUM + "'"
                        if satelliteexist is not None:
                                NewPlots_Layer.transparency = 40
                        arcpy.mapping.AddLayer(pDataFrame, NewPlots_Layer, "BOTTOM")
                                
                else:
                        NewPlots_Layer = arcpy.mapping.Layer(LayersPath + "\\" + "NewPlots.lyr")
                        if NewPlots_Layer.supports("LABELCLASSES"):
                                if NewPlots_Layer.showLabels:
                                        for lblClass in NewPlots_Layer.labelClasses:
                                                if lblClass.className == "Default":
                                                #if lblClass.showClassLabels:
                                                        lblClass.expression = lblClass.expression = "\"<FNT size = '"+ str(PLOT_LABEL) +"'>\" & [PLOTNUMBER] & \"</FNT>\""
                        NewPlots_Layer.definitionQuery = "REQNUM = '" + REQNUM + "'"
                        if satelliteexist is not None:
                                NewPlots_Layer.transparency = 40
                        arcpy.mapping.AddLayer(pDataFrame, NewPlots_Layer, "BOTTOM") 

        #===========================================================================================================
        arcpy.AddMessage("Setting map extent and scale")
        #-----------------------------------------------------------------------------------------------------------
        pExtent= arcpy.Extent(MAP_XMIN,MAP_YMIN,MAP_XMAX,MAP_YMAX)
        pExtent.spatialReference = pSpatialReference
        pDataFrame.extent = pExtent
        if Scale <> "":
                pDataFrame.scale = Scale
        #===========================================================================================================       
        lyname = "PLANNED_ROAD_EDGE_SML"
        if lyname in lylist:
                PLANNED_ROAD_EDGE_SML_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_EDGE_SML_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_CENTRE_LINE_SML"
        if lyname in lylist:
                PLANNED_ROAD_CENTRE_LINE_SML_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_CENTRE_LINE_SML_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_EDGE"
        if lyname in lylist:
                PLANNED_ROAD_EDGE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_EDGE_Layer, "BOTTOM")

        lyname = "PLANNED_ROAD_CENTRE_LINE"
        if lyname in lylist:
                PLANNED_ROAD_CENTRE_LINE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, PLANNED_ROAD_CENTRE_LINE_Layer, "BOTTOM")

        lyname = "ROAD_EDGE"
        if lyname in lylist:
                ROAD_EDGE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ROAD_EDGE_Layer, "BOTTOM")

        lyname = "ROAD_CENTRE_LINE"
        if lyname in lylist:
                ROAD_CENTRE_LINE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ROAD_CENTRE_LINE_Layer, "BOTTOM")

        lyname = "ZONE"
        if lyname in lylist:
                ZONE_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ZONE_Layer, "BOTTOM")

        lyname = "SECTOR"
        if lyname in lylist:
                SECTOR_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, SECTOR_Layer, "BOTTOM")

        lyname = "SERVICE_CORRIDOR"
        if lyname in lylist:
                SERVICE_CORRIDOR_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, SERVICE_CORRIDOR_Layer, "BOTTOM")

        lyname = "SATELLITE2018"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2017"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2019Nov"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        lyname = "SATELLITE2019Ortho"
        if lyname in lylist:
                ORTHO_Layer = arcpy.mapping.Layer(LayersPath + "\\" + lyname + ".lyr")
                arcpy.mapping.AddLayer(pDataFrame, ORTHO_Layer, "BOTTOM")

        #===========================================================================================================
        #arcpy.AddMessage("Setting map extent and scale")
        #-----------------------------------------------------------------------------------------------------------
        #pExtent= arcpy.Extent(MAP_XMIN,MAP_YMIN,MAP_XMAX,MAP_YMAX)
        #pExtent.spatialReference = pSpatialReference
        #pDataFrame.extent = pExtent
        #pDataFrame.scale = (round(pDataFrame.scale / 25) + 1) * 25
        #if Scale <> "":
                #mxd.activeView=pDataFrame.name
                #pDataFrame.scale = Scale
                #mxd.activeView='PAGE_LAYOUT'
                #arcpy.RefreshActiveView()
##                m = float(Scale)
##                n = 250.0
##                r = m % n
##                if r > n / 2.0:
##                    m = n * math.ceil(m / n)
##                elif r <= n / 2.0:
##                    m = n * math.floor(m / n)
##                pDataFrame.scale = m
                #pDataFrame.scale = (round(pDataFrame.scale / 25) + 1) * 25
        #===========================================================================================================
        #arcpy.AddMessage("Getting plots Info")
##        V_SM_PLOT = arcpy.mapping.ListTableViews(mxd,"V_SM_PLOT")[0]
##        pCursor = arcpy.da.SearchCursor(V_SM_PLOT, "*", "SITEMAPID = '" + SITEMAPID + "'")
##        SM_PLOTS = []
##        for row in pCursor:
##                SM_PLOTS.insert(len(SM_PLOTS),row)
##
##        ZONETPSSNAMEARA = SM_PLOTS[0][1]
##        SECTOR_NUMBER = SM_PLOTS[0][3]
        #===========================================================================================================
        arcpy.AddMessage("Setting Sitemap Info")
        #-----------------------------------------------------------------------------------------------------------
        for elm in arcpy.mapping.ListLayoutElements(mxd, "TEXT_ELEMENT"):
                if elm.name == "REQNUM":
                        if REQNUM is None: elm.text = " "
                        else: elm.text = REQNUM
                if elm.name == "TheDate":
                        if TheDate is None: elm.text = " "
                        else:elm.text = TheDate
                if elm.name == "Request":
                        if REQUEST_BY is None: elm.text = " "
                        else: elm.text = REQUEST_BY
                if elm.name == "RequestNo":
                        if LETTER_NO is None: elm.text = " "
                        else: elm.text = LETTER_NO
                if elm.name == "UPDAPPROVALLETTERNO":	
                        if UPD_LETTER_NO is None: elm.text = " "
                        else: elm.text = UPD_LETTER_NO
                if elm.name == "UPDAPPDATE":	
                        if UPD_LETTER_DATE is None: elm.text = " "
                        else: elm.text = UPD_LETTER_DATE
                if elm.name == "RequestDate":
                        if LETTER_DATE is None: elm.text = " "
                        else: elm.text = LETTER_DATE
                if elm.name == "Notes":
                        if REMARKS is None: elm.text = " "
                        else:
                                REMARKS = REMARKS.replace("\n","\\n")
                                REMARKS = REMARKS.replace(":(",":-(")
                                if(REMARKS_FONTSIZE is not None and REMARKS_FONTSIZE <> 0):
                                        elm.fontSize = REMARKS_FONTSIZE
                                        elm.text = REMARKS
                                #elm.fontSize = int(REMARKS_FONTSIZE)
                                #elm.text = REMARKS
                                #REMARKS = REMARKS.replace(")","")
                                #lengthofremarks = len(REMARKS)
                                #arcpy.AddMessage(lengthofremarks)
##                                if TempalteName == "MULTI_PLOTS_AP_A2":
##                                        if (lengthofremarks > 265 and lengthofremarks < 280):
##                                                elm.fontSize = 12.29
##                                                elm.text = REMARKS
##                                        elif lengthofremarks > 280:
##                                                elm.fontSize = 10.29
##                                                elm.text = REMARKS
##                                        else:
##                                                elm.text = REMARKS
##                                if TempalteName == "MULTI_PLOTS_AP_A1":
##                                        if (lengthofremarks > 265 and lengthofremarks < 275):
##                                                elm.fontSize = 18.21
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 275 and lengthofremarks < 285):
##                                                elm.fontSize = 16.21
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 295 and lengthofremarks < 305):
##                                                elm.fontSize = 14.21
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 325 and lengthofremarks < 335):
##                                                elm.fontSize = 12.21
##                                                elm.text = REMARKS
##                                        elif lengthofremarks > 335:
##                                                elm.fontSize = 10.21
##                                                elm.text = REMARKS
##                                        else:
##                                                elm.text = REMARKS
##                                if TempalteName == "MULTI_PLOTS_AP_A0":
##                                        if (lengthofremarks > 265 and lengthofremarks < 275):
##                                                elm.fontSize = 26.62
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 275 and lengthofremarks < 285):
##                                                elm.fontSize = 24.62
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 295 and lengthofremarks < 305):
##                                                elm.fontSize = 20.62
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 325 and lengthofremarks < 335):
##                                                elm.fontSize = 18.62
##                                                elm.text = REMARKS
##                                        elif (lengthofremarks > 335):
##                                                elm.fontSize = 16.62
##                                                elm.text = REMARKS
##                                        else:
##                                                elm.text = REMARKS
                #+++++++++++++++++++++++++++++++++++++++++++
                #+++++++++++++++++++++++++++++++++++++++++++
                if elm.name == "Zone":
                        if Zone is None: elm.text = " "
                        else:
##                                if(ZONE_FONTSIZE is not None and ZONE_FONTSIZE <> 0):
##                                        elm.fontSize = ZONE_FONTSIZE
                                if Zone == "Bulk":
                                        elm.text = "Õ”» «·ÃœÊ· «·„—›ﬁ"
                                else:
                                        elm.text = Zone
                if elm.name == "Sector":
                        if Sector is None: elm.text = " "
                        else:
##                                if(SECTOR_FONTSIZE is not None and SECTOR_FONTSIZE <> 0):
##                                        elm.fontSize = SECTOR_FONTSIZE
                                if Sector == "Bulk":
                                        elm.text = "Õ”» «·ÃœÊ· «·„—›ﬁ"
                                else:
                                        elm.text = Sector
                if elm.name == "Plot":
                        if Plot is None: elm.text = " "
                        else: elm.text = Plot
                if elm.name == "Action":
                        if purpose is None: elm.text = " "
                        else:
                                if(ACTION_FONTSIZE is not None and ACTION_FONTSIZE <> 0):
                                        elm.fontSize = ACTION_FONTSIZE
                                elm.text = purpose
                if elm.name == "UserName":
                        if UserName is None: elm.text = " "
                        else: elm.text = UserName
                if elm.name == "TemplateName":
                        if TempalteName is None: elm.text = " "
                        else: elm.text = TempalteName
##                if elm.name == "ENGINEER_NAME":
##                        if ENGINEER_NAME is None: elm.text = " "
##                        else: elm.text = ENGINEER_NAME
                if elm.name == "CopyTo":
                        if CopyTo == "0": elm.text = " "
##                        else: elm.text = CopyTo
                if elm.name == "Payee":
                        if IS_SRVC_PAYABLE == "0": elm.text = " "
##                        else: elm.text = CopyTo
        #===========================================================================================================
        arcpy.AddMessage("Setting QR Code Image")
        #-----------------------------------------------------------------------------------------------------------
        if not os.path.exists(os.path.dirname(ARCHIVE_PATH)):
                os.makedirs(os.path.dirname(ARCHIVE_PATH))
        Excel_PIC = arcpy.mapping.ListLayoutElements(mxd, "PICTURE_ELEMENT", "Excel")[0]
        excelimgname = None
        for subdirs, dirs, files in os.walk(ARCHIVE_PATH):
                for name in files:
                        basename = os.path.splitext(name)[0]
                        if basename == REQNUM + "_EXCEL":
                                excelimgname = name 
        if excelimgname <> None:                
                imagepath = ARCHIVE_PATH + excelimgname
                excelwidth = Excel_PIC.elementWidth
                excelheight = Excel_PIC.elementHeight
                result = [x.strip() for x in Excel.split(',')]
                if(result is not None and len(result) == 2):
                        arcpy.AddMessage(result)
                        excelwidth = float(result[0])
                        excelheight = float(result[1])
                else:
                        excelraster = arcpy.sa.Raster(imagepath)
                        excelheight = excelraster.height
                        excelwidth = excelraster.width
                        excelwidth = (excelwidth * 2.54 ) / 96.0
                        excelheight = (excelheight * 2.54 ) / 96.0
                        
               
                
                Excel_PIC.sourceImage = imagepath
                #Excel_PIC.elementPositionX = 1
                Excel_PICy = pDataFrame.elementPositionY
                Excel_PICHeight = pDataFrame.elementHeight
                Excel_PIC.elementPositionY = (Excel_PICy + Excel_PICHeight) - excelheight
                Excel_PIC.elementWidth = excelwidth
                Excel_PIC.elementHeight = excelheight
                #arcpy.AddMessage("Excel Size requested " + str(excelwidth) + " X " + str(excelheight))
                #arcpy.AddMessage("Excel Size dim " + str(Excel_PIC.elementWidth) + " X " + str(Excel_PIC.elementHeight))
        else:
                Excel_PIC.elementWidth = 0
                Excel_PIC.elementHeight = 0
        
##        insertLayer = arcpy.mapping.Layer(r"\\AD007APP06\gisapplications\gisapps\sddsps\Templates\Layers\NewPlots1.lyr")
##        insertLayer.definitionQuery = "REQNUM = '" + REQNUM + "'"
##        arcpy.mapping.AddLayer(pDataFrame, insertLayer, "BOTTOM")
        
        Legend_PIC = arcpy.mapping.ListLayoutElements(mxd, "LEGEND_ELEMENT", "Legend")[0]
        Legend_PIC.title = ""
        
        CatTypeCount = arcpy.da.TableToNumPyArray(NewPlots_Layer,"PLANNEDCATEGORYTYPE","REQNUM = '" + REQNUM + "'",skip_nulls = True)
        CatTypeCount = numpy.unique(CatTypeCount["PLANNEDCATEGORYTYPE"])
        CatTypeCount = len(CatTypeCount)
##        if CatTypeCount <= 20:
        Legend_PIC.adjustColumnCount(500)
##        else:
##                Legend_PIC.adjustColumnCount(CatTypeCount)
        
        for lyr in Legend_PIC.listLegendItemLayers():
            if lyr.name <> "NewPlotsMasterPlan":
                if lyr.name <> "PLOTDESIGN_Adjustment":
                        Legend_PIC.removeItem(lyr)
        for lyr in Legend_PIC.listLegendItemLayers():
                Legend_PIC.updateItem(lyr, use_visible_extent = True)
                

##            if lyr.name == "NewPlotsMasterPlan":
##                Legend_PIC.updateItem(lyr, use_visible_extent = True)
##                Legend_PIC.title = ""
                #styleItem = arcpy.mapping.ListStyleItems("USER_STYLE", "Legend Items", "MyStyle")[0]
                #Legend_PIC.updateItem(lyr, styleItem)
                #Legend_PIC.adjustColumnCount(500)
                #Legend_PIC.updateItem(lyr, use_visible_extent = True)
                #Legend_PIC.title = ""
                
                
                
        

                #arcpy.AddMessage(updateItem)
##        for lyr in arcpy.mapping.ListLayers(mxd, '', pDataFrame):
##            arcpy.AddMessage(str(lyr.name))
##            if lyr.name == "NewPlots1":
##                Legend_PIC = arcpy.mapping.ListLayoutElements(mxd, "LEGEND_ELEMENT", "Legend")[0]
##                arcpy.mapping.AddLayer(pDataFrame,insertLayer,"BOTTOM")
        #Legend_PIC = arcpy.mapping.ListLayoutElements(mxd, "LEGEND_ELEMENT", "Legend")[0]
        #refLayer = arcpy.mapping.ListLayers(mxd, "*", pDataFrame)[0]
        #arcpy.mapping.AddLayer(pDataFrame,insertLayer,"BOTTOM")
##        legendimgname = None
##        for subdirs, dirs, files in os.walk(ARCHIVE_PATH):
##                for name in files:                        
##                        basename = os.path.splitext(name)[0]
##                        if basename == REQNUM + "_LEGEND":
##                                legendimgname = name
##        
##        if legendimgname <> None:
##                imagepath = ARCHIVE_PATH + legendimgname                
##                Legendwidth = Legend_PIC.elementWidth
##                Legendheight = Legend_PIC.elementHeight
##                result = [x.strip() for x in Legend.split(',')]
##                if(result is not None and len(result) == 2):
##                        arcpy.AddMessage(result)
##                        Legendwidth = float(result[0])
##                        Legendheight = float(result[1])
##                else:
##                        Legendraster = arcpy.sa.Raster(imagepath)
##                        Legendheight = Legendraster.height
##                        Legendwidth = Legendraster.width
##                        Legendwidth = (Legendwidth * 2.54 ) / 96.0
##                        Legendheight = (Legendheight * 2.54 ) / 96.0   
##              
##                
##                Legend_PIC.sourceImage = imagepath
##                #Legend_PIC.elementPositionX = 1
##                #Legend_PIC.elementPositionY = 5.6
##                Legend_PIC.elementWidth = Legendwidth
##                Legend_PIC.elementHeight = Legendheight
##                #arcpy.AddMessage("Legend Size requested " + str(Legendwidth) + " X " + str(Legendheight))
##                #arcpy.AddMessage("Legend image dim " + str(Legend_PIC.elementWidth) + " X " + str(Legend_PIC.elementHeight))
##        else:
##                Legend_PIC.elementWidth = 0
##                Legend_PIC.elementHeight = 0
                
        #===========================================================================================================
        arcpy.AddMessage("Exporting SITEMAP to PDF")
        #-----------------------------------------------------------------------------------------------------------
        mxd.saveACopy(ARCHIVE_PATH + REQNUM + "_AP" + ".mxd")
        arcpy.mapping.ExportToPDF(mxd, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF",resolution=600,embed_fonts=True, image_quality="NORMAL")
        arcpy.SetParameterAsText(2, ARCHIVE_PATH + REQNUM + "_AP" + ".PDF")
        arcpy.SetParameterAsText(3, "Success")
else:
        arcpy.SetParameterAsText(3, "Failure")



                                                                Y@      Y@                    v>Z∂ì)—öC Ä«Ï\ñ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                